#!/bin/sh
set -eu

screenshots_dir="$HOME/Pictures/screenshots"
[ -d "$screenshots_dir" ] || mkdir -p "$screenshots_dir"

show_menu() {
  printf '%s' "$2" | rofi -dmenu \
    -p "$1" \
    -markup-rows \
    -no-custom \
    -sep ':' \
    -theme "$XDG_CONFIG_HOME/rofi/screenshot.$3.rasi"
}

choice_type=$(show_menu "screenshot type >" "󰍹  Screen:󱣴  Area" "type") || exit 1
case "$choice_type" in
  "󰍹  Screen") type="screen";;
  "󱣴  Area") type="area";;
esac

choice_action=$(show_menu "action >" "  Copy:  Save:  Copy &amp; Save" "action") || exit 1
case "$choice_action" in
  "  Copy") action="copy";;
  "  Save") action="save";;
  "  Copy &amp; Save") action="copysave";;
esac

set -- -f -n
[ "$type" = screen ] && set -- "$@" -c
set -- "$@" "$action" "$type"

sleep .2 # so rofi can close

DEFAULT_TARGET_DIR="$screenshots_dir" \
DATE_FORMAT="%Y%m%d%H%M%S" \
SLURP_ARGS="-d -b 10101022 -c e8e8e8ee -s bd9bd933" \
grimblast "$@"
